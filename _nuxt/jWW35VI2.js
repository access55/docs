import{d as N,bN as R,C as S,D as A,X as g,aj as q,bX as C,bY as d,b2 as I,bZ as L,b_ as V}from"./DDYCBnog.js";import{f as $,h as E}from"./CayEAvHG.js";import{f as F}from"./BneCoJRQ.js";const v=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],h="default",O=/^@|^v-on:/,w=/^:|^v-bind:/,x=/^v-model/,K=["select","textarea","input"],U=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(t=>[t,`prose-${t}`])),rt=N({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(t){var c,i,a,p,l,u,f,j;const e=(a=(i=(c=R())==null?void 0:c.appContext)==null?void 0:i.app)==null?void 0:a.$nuxt,r=(e==null?void 0:e.$route)||(e==null?void 0:e._route),{mdc:n}=((p=e==null?void 0:e.$config)==null?void 0:p.public)||{},o={...(l=n==null?void 0:n.components)!=null&&l.prose&&t.prose!==!1?U:{},...((u=n==null?void 0:n.components)==null?void 0:u.map)||{},...S(((j=(f=t.data)==null?void 0:f.mdc)==null?void 0:j.components)||{}),...t.components},s=A(()=>{var T;const D=(((T=t.body)==null?void 0:T.children)||[]).map(m=>m.tag||m.type).filter(m=>!v.includes(m));return Array.from(new Set(D)).sort().join(".")});return await M(t.body,{tags:o}),{tags:o,contentKey:s,route:r}},render(t){var u,f;const{tags:e,tag:r,body:n,data:o,contentKey:s,route:c,unwrap:i}=t;if(!n)return null;const a={...o,tags:e,$route:c},p=r!==!1?_(r||((u=a.component)==null?void 0:u.name)||a.component||"div"):void 0;return p?g(p,{...(f=a.component)==null?void 0:f.props,class:t.class,...this.$attrs,key:s},{default:l}):l==null?void 0:l();function l(){return i?F(y(n,g,a,a).default(),typeof i=="string"?i.split(" "):["*"]):y(n,g,a,a).default()}}});function W(t,e,r,n={}){if(t.type==="text")return e(d,t.value);if(t.type==="comment")return e(L,null,t.value);const o=t.tag,s=B(t,r.tags);if(t.tag==="binding")return X(t,e,r,n);const c=_(s);typeof c=="object"&&(c.tag=o);const i=z(t,r);return e(c,i,y(t,e,r,{...n,...i}))}function X(t,e,r,n={}){var p,l;const o={...n,$document:r,$doc:r},s=/\.|\[(\d+)\]/,i=((p=t.props)==null?void 0:p.value.trim().split(s).filter(Boolean)).reduce((u,f)=>{if(u&&f in u)return typeof u[f]=="function"?u[f]():u[f]},o),a=(l=t.props)==null?void 0:l.defaultValue;return e(d,i??a??"")}function y(t,e,r,n){const s=(t.children||[]).reduce((i,a)=>{if(!J(a))return i[h].push(a),i;const p=H(a);return i[p]=i[p]||[],a.type==="element"&&i[p].push(...a.children||[]),i},{[h]:[]});return Object.entries(s).reduce((i,[a,p])=>(p.length&&(i[a]=()=>{const l=p.map(u=>W(u,e,r,n));return Q(l)}),i),{})}function z(t,e){const{tag:r="",props:n={}}=t;return Object.keys(n).reduce(function(o,s){if(s==="__ignoreMap")return o;const c=n[s];if(x.test(s)&&!K.includes(r))return P(s,c,o,e);if(s==="v-bind")return Y(s,c,o,e);if(O.test(s))return Z(s,c,o,e);if(w.test(s))return G(s,c,o,e);const{attribute:i}=$(E,s);return Array.isArray(c)&&c.every(a=>typeof a=="string")?(o[i]=c.join(" "),o):(o[i]=c,o)},{})}function P(t,e,r,n){const o=u=>+u,s=u=>u.trim(),c=u=>u,i=t.replace(x,"").split(".").filter(u=>u).reduce((u,f)=>(u[f]=!0,u),{}),a="value",p=i.lazy?"change":"input",l=i.number?o:i.trim?s:c;return r[a]=b(e,n),r.on=r.on||{},r.on[p]=u=>n[e]=l(u),r}function Y(t,e,r,n){const o=b(e,n);return r=Object.assign(r,o),r}function Z(t,e,r,n){return t=t.replace(O,""),r.on=r.on||{},r.on[t]=()=>b(e,n),r}function G(t,e,r,n){return t=t.replace(w,""),r[t]=b(e,n),r}const _=t=>{if(!v.includes(t)&&!(t!=null&&t.render)&&!(t!=null&&t.ssrRender)){const e=q(C(t),!1);if(typeof e=="object")return e}return t};function b(t,e){const r=t.split(".").reduce((n,o)=>typeof n=="object"?n[o]:void 0,e);return typeof r>"u"?V(t):r}function H(t){let e="";for(const r of Object.keys(t.props||{}))if(!(!r.startsWith("#")&&!r.startsWith("v-slot:"))){e=r.split(/[:#]/,2)[1];break}return e||h}function J(t){return t.tag==="template"}function Q(t){const e=[];for(const r of t){const n=e[e.length-1];r.type===d&&(n==null?void 0:n.type)===d?n.children=n.children+r.children:e.push(r)}return e}async function M(t,e){if(!t)return;const r=Array.from(new Set(n(t,e)));await Promise.all(r.map(async o=>{if(o!=null&&o.render||o!=null&&o.ssrRender||o!=null&&o.__ssrInlineRender)return;const s=_(o);s!=null&&s.__asyncLoader&&!s.__asyncResolved&&await s.__asyncLoader()}));function n(o,s){const c=o.tag;if(o.type==="text"||c==="binding"||o.type==="comment")return[];const i=B(o,s.tags),a=[];o.type!=="root"&&!v.includes(i)&&a.push(i);for(const p of o.children||[])a.push(...n(p,s));return a}}function B(t,e){var n;const r=t.tag;return!r||typeof((n=t.props)==null?void 0:n.__ignoreMap)<"u"?r:e[r]||e[C(r)]||e[I(t.tag)]||r}export{rt as _,v as h};
